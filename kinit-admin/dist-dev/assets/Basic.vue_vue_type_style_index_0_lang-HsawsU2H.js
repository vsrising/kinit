var h=(_,n,c)=>new Promise((r,f)=>{var g=s=>{try{p(c.next(s))}catch(m){f(m)}},w=s=>{try{p(c.throw(s))}catch(m){f(m)}},p=s=>s.done?r(s.value):Promise.resolve(s.value).then(g,w);p((c=c.apply(_,n)).next())});import{u as k,F as E}from"./useForm-agan0gLz.js";import{i as L,u as M,a as V,I,q as B,a1 as D,o as F}from"./index-E_cr-WWq.js";import{u as N}from"./useValidator-b4d-vg8t.js";import{a as P,J as S,b as l}from"./element-plus-LfFKO5To.js";import{l as T,e as J,J as v,O as a,V as R,P as j,a as x,m as q,W as K,u as O}from"./vue-chunks-NBL-ZipP.js";const Z=T({__name:"Basic",props:{tabId:L.number},setup(_){const{required:n}=N(),c=M(),r=V(),f=_,g=J(()=>c.getToken),w=v([{field:"web_title",label:"系统标题",colProps:{span:24},component:"Input",componentProps:{style:{width:"500px"}}},{field:"web_logo",label:"系统 LOGO",colProps:{span:24},formItemProps:{slots:{default:e=>a(S,{class:"system-settings-basic-image-uploader",action:"/api/vadmin/system/upload/image/to/local",data:{path:"system"},"show-file-list":!1,"before-upload":o=>{const u=["image/jpeg","image/gif","image/png"].includes(o.type),d=o.size/1024/1024<5;return u||l.error("上传LOGO图片必须是 JPG/GIF/PNG/ 格式!"),d||l.error("上传LOGO图片大小不能超过 5MB!"),u&&d},"on-success":o=>{o.code===200?e.web_logo=o.data.remote_path:l.error(o.message)},accept:"image/jpeg,image/gif,image/png",name:"file",headers:{Authorization:g}},{default:()=>[e.web_logo?a("img",{src:e.web_logo,class:"logo-image"},null):a(P,{class:"logo-image-uploader-icon"},{default:()=>[a(I,{icon:"akar-icons:plus",size:23},null)]})]})}}},{field:"web_desc",label:"系统描述",colProps:{span:24},component:"Input",componentProps:{rows:4,type:"textarea",style:{width:"500px"}}},{field:"web_ico",label:"ICO 图标",colProps:{span:24},formItemProps:{slots:{default:e=>a(S,{class:"system-settings-basic-image-uploader",action:"/api/vadmin/system/upload/image/to/local",data:{path:"system"},"show-file-list":!1,"before-upload":o=>{const u=["image/x-icon"].includes(o.type),d=o.size/1024/1024<2;return u||l.error("上传ICO图标必须是 ico 格式!"),d||l.error("上传ICO图标大小不能超过 2MB!"),u&&d},"on-success":o=>{o.code===200?(e.web_ico=o.data.remote_path,e.web_ico_local_path=o.data.local_path):l.error(o.message)},accept:"image/x-icon",name:"file",headers:{Authorization:g}},{default:()=>[e.web_ico?a("img",{src:e.web_ico,class:"ico-image"},null):a(P,{class:"ico-image-uploader-icon"},{default:()=>[a(I,{icon:"akar-icons:plus",size:23},null)]})]})}}},{field:"web_ico_local_path",label:"ICO 图标服务器文件地址",component:"Input",colProps:{span:24},hidden:!0},{field:"web_icp_number",label:"备案号",colProps:{span:24},component:"Input",componentProps:{style:{width:"500px"}}},{field:"web_copyright",label:"版权信息",colProps:{span:24},component:"Input",componentProps:{style:{width:"500px"}}},{field:"active",label:"",colProps:{span:24},formItemProps:{slots:{default:()=>a(j,null,[a(B,{loading:b.value,type:"primary",onClick:G},{default:()=>[R("立即提交")]})])}}}]),p=v({web_title:[n()],web_logo:[n()],web_ico:[n()]}),{formRegister:s,formMethods:m}=k(),{setValues:U,getFormData:z,getElFormExpose:y}=m;let A=x({});const C=()=>h(this,null,function*(){const e=yield F({tab_id:f.tabId});if(e){yield U(e.data),A.value=e.data;const i=yield y();i==null||i.clearValidate()}}),b=x(!1),G=()=>h(this,null,function*(){const e=yield y();if(yield e==null?void 0:e.validate()){const t=yield z();if(b.value=!0,!t)return b.value=!1,l.error("未获取到数据");try{if(yield D(t))return r.setTitle(t.web_title||"后台系统-开发"),r.setLogoImage(t.web_logo||"/media/system/logo.png"),r.setFooterContent(t.web_copyright||"Copyright ©2022-present K"),r.setIcpNumber(t.web_icp_number||""),l.success("更新成功")}finally{b.value=!1}}});return C(),(e,i)=>(q(),K(O(E),{rules:p,onRegister:O(s),schema:w},null,8,["rules","onRegister","schema"]))}});export{Z as _};
//# sourceMappingURL=Basic.vue_vue_type_style_index_0_lang-HsawsU2H.js.map
