var v=(x,w,f)=>new Promise((_,g)=>{var h=s=>{try{r(f.next(s))}catch(m){g(m)}},k=s=>{try{r(f.throw(s))}catch(m){g(m)}},r=s=>s.done?_(s.value):Promise.resolve(s.value).then(h,k);r((f=f.apply(x,w)).next())});import{g as T,d as N,a as I,p as P}from"./dept-DYFaTeMe.js";import{u as U,_ as q}from"./Table.vue_vue_type_script_lang-mknq5iMW.js";import{d as J,q as c}from"./index-E_cr-WWq.js";import{_ as M}from"./ContentWrap.vue_vue_type_script_setup_true_lang-M_zuHec9.js";import{_ as O}from"./Write.vue_vue_type_script_setup_true_lang-E9AD3xkN.js";import{_ as W}from"./Dialog.vue_vue_type_style_index_0_lang-ZHiEjFP2.js";import{z as X,m as j,g as G}from"./element-plus-LfFKO5To.js";import{l as H,J as K,O as l,P as R,V as p,a as i,m as V,p as Q,R as n,u as t,U as S,W as Y,X as Z}from"./vue-chunks-NBL-ZipP.js";import"./useForm-agan0gLz.js";import"./style.css_vue_type_style_index_0_src_true_lang-vVOIijJh.js";import"./wang-editor-izIlk5n1.js";import"./_Uint8Array-x8CL7VG0.js";import"./useValidator-b4d-vg8t.js";const me=H({name:"AuthDept",__name:"Dept",setup(x){const{t:w}=J(),{tableRegister:f,tableState:_,tableMethods:g}=U({fetchDataApi:()=>v(this,null,function*(){const{pageSize:e,currentPage:a}=_,o=yield T({page:t(a),limit:t(e)});return{list:o.data||[],total:o.count||0}}),fetchDelApi:e=>v(this,null,function*(){return(yield N(e)).code===200})}),{dataList:h,loading:k}=_,{getList:r,delList:s}=g,m=K([{field:"name",label:"部门名称",disabled:!0,show:!0},{field:"dept_key",label:"部门标识",show:!0},{field:"owner",label:"负责人",show:!0},{field:"phone",label:"联系电话",show:!0},{field:"email",label:"邮箱",show:!0},{field:"desc",label:"描述",show:!0},{field:"order",label:"排序",width:"120px",show:!0},{field:"disabled",label:"是否禁用",width:"120px",show:!0,slots:{default:e=>{const a=e.row;return l(R,null,[l(X,{modelValue:!a.disabled,disabled:!0},null)])}}},{field:"action",width:"200px",label:"操作",show:!0,slots:{default:e=>{const a=e.row;return l(R,null,[l(c,{type:"primary",link:!0,size:"small",onClick:()=>$(a)},{default:()=>[p("编辑")]}),l(c,{type:"primary",link:!0,size:"small",onClick:()=>B(a)},{default:()=>[p("添加子部门")]}),l(c,{type:"danger",loading:D.value,link:!0,size:"small",onClick:()=>E(a)},{default:()=>[p("删除")]})])}}}]),D=i(!1),E=e=>v(this,null,function*(){D.value=!0,yield s(!0,[e.id]).finally(()=>{D.value=!1})}),u=i(!1),y=i(""),b=i(),A=i(void 0),d=i(""),L=i(),C=i(!1),$=e=>{y.value="编辑",d.value="edit",b.value=e,u.value=!0},z=()=>{y.value="新增",d.value="add",b.value=void 0,u.value=!0},B=e=>{y.value="添加子部门",d.value="addSon",A.value=e.id,b.value=void 0,u.value=!0},F=()=>v(this,null,function*(){const e=t(L),a=yield e==null?void 0:e.submit();if(a){C.value=!0;try{const o=i({});d.value==="add"||d.value==="addSon"?(o.value=yield I(a),o.value&&(A.value=void 0,u.value=!1,r())):d.value==="edit"&&(o.value=yield P(a),o.value&&(u.value=!1,r()))}finally{C.value=!1}}});return(e,a)=>(V(),Q(R,null,[l(t(M),null,{default:n(()=>[l(t(q),{columns:m,showAction:"","default-expand-all":"","node-key":"id",data:t(h),loading:t(k),onRegister:t(f),onRefresh:t(r)},{toolbar:n(()=>[l(t(j),{gutter:10},{default:n(()=>[l(t(G),{span:1.5},{default:n(()=>[l(t(c),{type:"primary",onClick:z},{default:n(()=>[p("新增部门")]),_:1})]),_:1})]),_:1})]),_:1},8,["columns","data","loading","onRegister","onRefresh"])]),_:1}),l(t(W),{modelValue:u.value,"onUpdate:modelValue":a[1]||(a[1]=o=>u.value=o),title:y.value},{footer:n(()=>[d.value!=="detail"?(V(),Y(t(c),{key:0,type:"primary",loading:C.value,onClick:F},{default:n(()=>[p(S(t(w)("exampleDemo.save")),1)]),_:1},8,["loading"])):Z("",!0),l(t(c),{onClick:a[0]||(a[0]=o=>u.value=!1)},{default:n(()=>[p(S(t(w)("dialogDemo.close")),1)]),_:1})]),default:n(()=>[l(O,{ref_key:"writeRef",ref:L,"current-row":b.value,"parent-id":A.value},null,8,["current-row","parent-id"])]),_:1},8,["modelValue","title"])],64))}});export{me as default};
//# sourceMappingURL=Dept-sXDIjrp1.js.map
