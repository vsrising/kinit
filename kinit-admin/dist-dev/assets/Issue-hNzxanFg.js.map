{"version":3,"file":"Issue-hNzxanFg.js","sources":["../../src/views/Vadmin/Help/Issue/Issue.vue"],"sourcesContent":["<script setup lang=\"tsx\">\nimport { reactive, ref, unref } from 'vue'\nimport { getIssueListApi, delIssueListApi } from '@/api/vadmin/help/issue'\nimport { useTable } from '@/hooks/web/useTable'\nimport { Table, TableColumn } from '@/components/Table'\nimport { ElSwitch, ElRow, ElCol } from 'element-plus'\nimport { Search } from '@/components/Search'\nimport { FormSchema } from '@/components/Form'\nimport { ContentWrap } from '@/components/ContentWrap'\nimport { useDictStore } from '@/store/modules/dict'\nimport { DictDetail } from '@/utils/dict'\nimport { useRouter } from 'vue-router'\nimport { BaseButton } from '@/components/Button'\n\ndefineOptions({\n  name: 'HelpIssue'\n})\n\nconst { push } = useRouter()\n\nconst { tableRegister, tableState, tableMethods } = useTable({\n  fetchDataApi: async () => {\n    const { pageSize, currentPage } = tableState\n    const res = await getIssueListApi({\n      page: unref(currentPage),\n      limit: unref(pageSize),\n      ...unref(searchParams)\n    })\n    return {\n      list: res.data || [],\n      total: res.count || 0\n    }\n  },\n  fetchDelApi: async (value) => {\n    const res = await delIssueListApi(value)\n    return res.code === 200\n  }\n})\n\nconst { dataList, loading, total, pageSize, currentPage } = tableState\nconst { getList, delList } = tableMethods\n\nconst platformOptions = ref<DictDetail[]>([])\n\nconst getOptions = async () => {\n  const dictStore = useDictStore()\n  const dictOptions = await dictStore.getDictObj(['sys_vadmin_platform'])\n  platformOptions.value = dictOptions.sys_vadmin_platform\n}\n\ngetOptions()\n\nconst tableColumns = reactive<TableColumn[]>([\n  {\n    field: 'id',\n    label: '编号',\n    show: true,\n    disabled: true,\n    width: '120px'\n  },\n  {\n    field: 'category.name',\n    label: '类别名称',\n    width: '200px',\n    show: true,\n    disabled: true\n  },\n  {\n    field: 'title',\n    label: '标题',\n    show: true\n  },\n  {\n    field: 'view_number',\n    label: '查看次数',\n    show: true,\n    width: '100px'\n  },\n  {\n    field: 'is_active',\n    label: '是否可见',\n    show: true,\n    width: '100px',\n    slots: {\n      default: (data: any) => {\n        const row = data.row\n        return (\n          <>\n            <ElSwitch modelValue={row.is_active} disabled />\n          </>\n        )\n      }\n    }\n  },\n  {\n    field: 'create_datetime',\n    label: '创建时间',\n    show: true,\n    width: '200px',\n    sortable: true\n  },\n  {\n    field: 'create_user.name',\n    label: '创建人',\n    show: true,\n    width: '100px'\n  },\n  {\n    field: 'action',\n    width: '120px',\n    label: '操作',\n    show: true,\n    slots: {\n      default: (data: any) => {\n        const row = data.row\n        return (\n          <>\n            <BaseButton type=\"primary\" link size=\"small\" onClick={() => editAction(row)}>\n              编辑\n            </BaseButton>\n            <BaseButton\n              type=\"danger\"\n              loading={delLoading.value}\n              link\n              size=\"small\"\n              onClick={() => delData(row)}\n            >\n              删除\n            </BaseButton>\n          </>\n        )\n      }\n    }\n  }\n])\n\nconst searchSchema = reactive<FormSchema[]>([\n  {\n    field: 'name',\n    label: '类别名称',\n    component: 'Input',\n    componentProps: {\n      clearable: true,\n      style: {\n        width: '214px'\n      }\n    }\n  },\n  {\n    field: 'platform',\n    label: '登录平台',\n    component: 'Select',\n    componentProps: {\n      style: {\n        width: '214px'\n      },\n      options: platformOptions.value\n    }\n  },\n  {\n    field: 'is_active',\n    label: '是否可见',\n    component: 'Select',\n    componentProps: {\n      style: {\n        width: '214px'\n      },\n      options: [\n        {\n          label: '可见',\n          value: true\n        },\n        {\n          label: '不可见',\n          value: false\n        }\n      ]\n    }\n  }\n])\n\nconst searchParams = ref({})\nconst setSearchParams = (data: any) => {\n  currentPage.value = 1\n  searchParams.value = data\n  getList()\n}\n\nconst delLoading = ref(false)\n\nconst delData = async (row: any) => {\n  delLoading.value = true\n  await delList(true, [row.id]).finally(() => {\n    delLoading.value = false\n  })\n}\n\nconst editAction = async (row: any) => {\n  push(`/help/issue/form?id=${row.id}`)\n}\n\nconst addAction = () => {\n  push('/help/issue/form')\n}\n</script>\n\n<template>\n  <ContentWrap>\n    <Search :schema=\"searchSchema\" @reset=\"setSearchParams\" @search=\"setSearchParams\" />\n    <Table\n      v-model:current-page=\"currentPage\"\n      v-model:page-size=\"pageSize\"\n      showAction\n      :columns=\"tableColumns\"\n      default-expand-all\n      node-key=\"id\"\n      :data=\"dataList\"\n      :loading=\"loading\"\n      :pagination=\"{\n        total\n      }\"\n      @register=\"tableRegister\"\n      @refresh=\"getList\"\n    >\n      <template #toolbar>\n        <ElRow :gutter=\"10\">\n          <ElCol :span=\"1.5\">\n            <BaseButton type=\"primary\" @click=\"addAction\">新增常见问题</BaseButton>\n          </ElCol>\n        </ElRow>\n      </template>\n    </Table>\n  </ContentWrap>\n</template>\n"],"names":["push","useRouter","tableRegister","tableState","tableMethods","useTable","fetchDataApi","__async","pageSize","currentPage","res","getIssueListApi","__spreadValues","page","unref","limit","searchParams","list","data","total","count","fetchDelApi","value","delIssueListApi","code","dataList","loading","getList","delList","platformOptions","ref","dictOptions","useDictStore","getDictObj","sys_vadmin_platform","tableColumns","reactive","field","label","show","disabled","width","slots","default","row","_createVNode2","_Fragment","ElSwitch","is_active","sortable","BaseButton","onClick","editAction","_createTextVNode2","delLoading","delData","searchSchema","component","componentProps","clearable","style","options","setSearchParams","id","finally","addAction"],"mappings":"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"}