var P=(n,h,a)=>new Promise((i,r)=>{var g=l=>{try{c(a.next(l))}catch(t){r(t)}},v=l=>{try{c(a.throw(l))}catch(t){r(t)}},c=l=>l.done?i(l.value):Promise.resolve(l.value).then(g,v);c((a=a.apply(n,h)).next())});import{u as D,F as M}from"./useForm-agan0gLz.js";import{e as O,u as B,q as C,I as u,g as N,d as J}from"./index-E_cr-WWq.js";import{l as T,aC as U,a as y,J as W,O as o,P as _,b as $,m as G,W as H,u as R,y as K}from"./vue-chunks-NBL-ZipP.js";import{u as Q}from"./useValidator-b4d-vg8t.js";import{x as X,q as Y}from"./element-plus-LfFKO5To.js";function I(n){return typeof n=="function"||Object.prototype.toString.call(n)==="[object Object]"&&!K(n)}const p="var(--el-color-primary)",m=30,f="#999",re=T({__name:"LoginForm",emits:["to-telephone"],setup(n,{emit:h}){const a=h,{required:i}=Q(),r=O(),g=B(),{currentRoute:v,addRoute:c,push:l}=U(),{t}=J(),x=y(!1),z={telephone:[i()],method:[i()],password:[i()]},S=W([{field:"title",colProps:{span:24},formItemProps:{slots:{default:()=>o("h2",{class:"text-2xl font-bold text-center w-[100%]"},[t("login.login")])}}},{field:"telephone",label:t("login.telephone"),value:"15020221010",component:"Input",colProps:{span:24},componentProps:{style:{width:"100%"},placeholder:t("login.telephonePlaceholder"),maxlength:11}},{field:"password",label:t("login.password"),value:"kinit2022",component:"InputPassword",colProps:{span:24},componentProps:{style:{width:"100%"},placeholder:t("login.passwordPlaceholder")}},{field:"method",label:"登录类型",value:"0",component:"Input",hidden:!0},{field:"tool",colProps:{span:24},formItemProps:{slots:{default:()=>{let e;return o(_,null,[o("div",{class:"flex justify-between items-center w-[100%]"},[o(X,{modelValue:x.value,"onUpdate:modelValue":s=>x.value=s,label:t("login.remember"),size:"small"},null),o(Y,{type:"primary",underline:!1},I(e=t("login.forgetPassword"))?e:{default:()=>[e]})])])}}}},{field:"login",colProps:{span:24},formItemProps:{slots:{default:()=>{let e,s;return o(_,null,[o("div",{class:"w-[100%]"},[o(C,{loading:d.value,type:"primary",class:"w-[100%]",onClick:L},I(e=t("login.login"))?e:{default:()=>[e]})]),o("div",{class:"w-[100%] mt-15px"},[o(C,{class:"w-[100%]",onClick:A},I(s=t("login.smsLogin"))?s:{default:()=>[s]})])])}}}},{field:"other",component:"Divider",label:t("login.otherLogin"),componentProps:{contentPosition:"center"}},{field:"otherIcon",colProps:{span:24},formItemProps:{slots:{default:()=>o(_,null,[o("div",{class:"flex justify-between w-[100%]"},[o(u,{icon:"ant-design:github-filled",size:m,class:"cursor-pointer ant-icon",color:f,hoverColor:p},null),o(u,{icon:"ant-design:wechat-filled",size:m,class:"cursor-pointer ant-icon",color:f,hoverColor:p},null),o(u,{icon:"ant-design:alipay-circle-filled",size:m,color:f,hoverColor:p,class:"cursor-pointer ant-icon"},null),o(u,{icon:"ant-design:weibo-circle-filled",size:m,color:f,hoverColor:p,class:"cursor-pointer ant-icon"},null)])])}}}]),{formRegister:F,formMethods:j}=D(),{getFormData:q,getElFormExpose:E}=j,d=y(!1),k=y("");$(()=>v.value,e=>{var s;k.value=(s=e==null?void 0:e.query)==null?void 0:s.redirect},{immediate:!0});const L=()=>P(this,null,function*(){const e=yield E();if(yield e==null?void 0:e.validate()){d.value=!0;const w=yield q();try{const b=yield g.login(w);b?b.data.is_reset_password?V():l({path:"/reset/password"}):d.value=!1}catch(b){d.value=!1}}}),V=()=>P(this,null,function*(){const e=yield N();if(e){const s=e.data||[];yield r.generateRoutes(s).catch(()=>{}),r.getAddRouters.forEach(w=>{c(w)}),r.setIsAddRouters(!0),l({path:k.value||r.addRouters[0].path})}}),A=()=>{a("to-telephone")};return(e,s)=>(G(),H(R(M),{schema:S,rules:z,"label-position":"top","hide-required-asterisk":"",size:"large",class:"dark:border-1 dark:border-[var(--el-border-color)] dark:border-solid",onRegister:R(F)},null,8,["schema","onRegister"]))}});export{re as _};
//# sourceMappingURL=LoginForm.vue_vue_type_script_setup_true_lang-rpZd9lAh.js.map
